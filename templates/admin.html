<!DOCTYPE html>
<html>
<head>
    <title>–ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å - –ñ–ö–• –ö–æ—Ä–æ–ª–µ–≤–∫–∞</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        /* ======== –°–í–ï–¢–õ–ê–Ø –¢–ï–ú–ê ======== */
        :root {
            --bg-color: #f8f9fa;
            --card-bg: white;
            --text-color: #212529;
            --text-muted: #6c757d;
            --border-color: #dee2e6;
            --table-header-bg: #f8f9fa;
            --table-hover: #f2f2f2;
        }

        /* ======== –¢–Å–ú–ù–ê–Ø –¢–ï–ú–ê ======== */
        [data-theme="dark"] {
            --bg-color: #1a1e24;
            --card-bg: #2a2f3c;
            --text-color: #e9ecef;
            --text-muted: #adb5bd;
            --border-color: #4a4f62;
            --table-header-bg: #2a2f3c;
            --table-hover: #3a4050;
        }

        body { 
            background: var(--bg-color); 
            color: var(--text-color);
            transition: all 0.3s ease;
        }
        .card {
            background: var(--card-bg);
            color: var(--text-color);
            border: 1px solid var(--border-color);
        }
        .card-header {
            background: var(--card-bg);
            color: var(--text-color);
            border-bottom: 1px solid var(--border-color);
        }
        .table {
            color: var(--text-color);
        }
        .table thead th {
            background: var(--table-header-bg);
            color: var(--text-color);
            border-color: var(--border-color);
        }
        .table td {
            border-color: var(--border-color);
        }
        .table-hover tbody tr:hover {
            background: var(--table-hover);
            color: var(--text-color);
        }
        .comment-cell { 
            max-width: 250px; 
            white-space: nowrap; 
            overflow: hidden; 
            text-overflow: ellipsis; 
        }
        .badge-score { 
            width: 35px; 
        }
        h1, h2, h3, h4, h5, h6 {
            color: var(--text-color);
        }
        .text-muted {
            color: var(--text-muted) !important;
        }

        /* ======== –ü–ï–†–ï–ö–õ–Æ–ß–ê–¢–ï–õ–¨ –¢–ï–ú ======== */
        .theme-switch-wrapper {
            display: flex;
            align-items: center;
            justify-content: flex-end;
            margin-bottom: 20px;
        }
        .theme-switch {
            display: inline-block;
            height: 34px;
            position: relative;
            width: 60px;
        }
        .theme-switch input {
            display: none;
        }
        .slider {
            background: #ccc;
            bottom: 0;
            cursor: pointer;
            left: 0;
            position: absolute;
            right: 0;
            top: 0;
            transition: .4s;
            border-radius: 34px;
        }
        .slider:before {
            background: white;
            bottom: 4px;
            content: "‚òÄÔ∏è";
            height: 26px;
            left: 4px;
            position: absolute;
            transition: .4s;
            width: 26px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 14px;
        }
        input:checked + .slider {
            background: #2c3e50;
        }
        input:checked + .slider:before {
            transform: translateX(26px);
            content: "üåô";
        }
        .theme-label {
            margin-right: 10px;
            color: var(--text-color);
            font-weight: 500;
        }
    </style>
</head>
<body>
    <div class="container-fluid py-4">
        <!-- –ü–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—å —Ç–µ–º -->
        <div class="theme-switch-wrapper">
            <span class="theme-label">–¢–µ–º–∞:</span>
            <label class="theme-switch">
                <input type="checkbox" id="theme-toggle">
                <span class="slider"></span>
            </label>
        </div>

        <div class="d-flex justify-content-between align-items-center mb-4">
            <h1>üîê –ü–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è</h1>
            <a href="/logout" class="btn btn-danger">–í—ã–π—Ç–∏</a>
        </div>

        <div class="card shadow">
            <div class="card-header bg-white d-flex justify-content-between align-items-center">
                <h5 class="mb-0">–í—Å–µ –æ—Ç–≤–µ—Ç—ã –∂–∏—Ç–µ–ª–µ–π</h5>
                <span class="badge bg-primary">{{ responses|length }} –∑–∞–ø–∏—Å–µ–π</span>
            </div>
            <div class="card-body">
                <div class="table-responsive">
                    <table class="table table-hover">
                        <thead>
                            <tr>
                                <th>ID</th>
                                <th>–î–∞—Ç–∞</th>
                                <th>–£–±–æ—Ä–∫–∞ –≤ –ø–æ–¥—ä–µ–∑–¥–µ</th>
                                <th>–û—Å–≤–µ—â–µ–Ω–∏–µ –≤ –ø–æ–¥—ä–µ–∑–¥–µ</th>
                                <th>–†–∞–±–æ—Ç–∞ –ª–∏—Ñ—Ç–∞</th>
                                <th>–£–±–æ—Ä–∫–∞ —Å–Ω–µ–≥–∞</th>
                                <th>–£–ª–∏—á–Ω–æ–µ –æ—Å–≤–µ—â–µ–Ω–∏–µ</th>
                                <th>–í—ã–≤–æ–∑ –º—É—Å–æ—Ä–∞</th>
                                <th>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for r in responses %}
                            <tr>
                                <td>{{ r.id }}</td>
                                <td>{{ r.timestamp.strftime('%d.%m.%Y %H:%M') if r.timestamp else '‚Äî' }}</td>
                                <td><span class="badge bg-{{ 'success' if r.cleaning_inside >= 4 else 'warning' if r.cleaning_inside == 3 else 'danger' }} badge-score">{{ r.cleaning_inside }}</span></td>
                                <td><span class="badge bg-{{ 'success' if r.lighting_inside >= 4 else 'warning' if r.lighting_inside == 3 else 'danger' }}">{{ r.lighting_inside }}</span></td>
                                <td><span class="badge bg-{{ 'success' if r.elevator >= 4 else 'warning' if r.elevator == 3 else 'danger' }}">{{ r.elevator }}</span></td>
                                <td><span class="badge bg-{{ 'success' if r.snow_removal >= 4 else 'warning' if r.snow_removal == 3 else 'danger' }}">{{ r.snow_removal }}</span></td>
                                <td><span class="badge bg-{{ 'success' if r.lighting_outside >= 4 else 'warning' if r.lighting_outside == 3 else 'danger' }}">{{ r.lighting_outside }}</span></td>
                                <td><span class="badge bg-{{ 'success' if r.garbage >= 4 else 'warning' if r.garbage == 3 else 'danger' }}">{{ r.garbage }}</span></td>
                                <td class="comment-cell" title="{{ r.comment }}">{{ r.comment or '‚Äî' }}</td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <div class="mt-4">
            <a href="/" class="btn btn-primary">üè† –ù–∞ –≥–ª–∞–≤–Ω—É—é</a>
            <a href="/results" class="btn btn-success">üìä –†–µ–∑—É–ª—å—Ç–∞—Ç—ã</a>
        </div>
    </div>

    <!-- –°–∫—Ä–∏–ø—Ç –¥–ª—è –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è —Ç–µ–º -->
    <script>
        const toggleSwitch = document.querySelector('#theme-toggle');
        const currentTheme = localStorage.getItem('theme');

        if (currentTheme) {
            document.documentElement.setAttribute('data-theme', currentTheme);
            if (currentTheme === 'dark') {
                toggleSwitch.checked = true;
            }
        }

        function switchTheme(e) {
            if (e.target.checked) {
                document.documentElement.setAttribute('data-theme', 'dark');
                localStorage.setItem('theme', 'dark');
            } else {
                document.documentElement.setAttribute('data-theme', 'light');
                localStorage.setItem('theme', 'light');
            }    
        }

        toggleSwitch.addEventListener('change', switchTheme, false);
    </script>
</body>
</html>
